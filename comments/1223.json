[
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/77988590",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-77988590",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 77988590,
    "user": {
      "login": "bwin",
      "id": 1673361,
      "avatar_url": "https://avatars1.githubusercontent.com/u/1673361?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bwin",
      "html_url": "https://github.com/bwin",
      "followers_url": "https://api.github.com/users/bwin/followers",
      "following_url": "https://api.github.com/users/bwin/following{/other_user}",
      "gists_url": "https://api.github.com/users/bwin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bwin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bwin/subscriptions",
      "organizations_url": "https://api.github.com/users/bwin/orgs",
      "repos_url": "https://api.github.com/users/bwin/repos",
      "events_url": "https://api.github.com/users/bwin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bwin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-10T03:12:14Z",
    "updated_at": "2015-03-10T03:12:14Z",
    "body": "`win.close = function() {}` overwrites the close function of your `win`. You're using jquery-syntax. Attach listeners with `win.on` instead.\n\nDon't know about different behaviour when closed from menu, though.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/77988874",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-77988874",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 77988874,
    "user": {
      "login": "shrewdlogarithm",
      "id": 4963937,
      "avatar_url": "https://avatars0.githubusercontent.com/u/4963937?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrewdlogarithm",
      "html_url": "https://github.com/shrewdlogarithm",
      "followers_url": "https://api.github.com/users/shrewdlogarithm/followers",
      "following_url": "https://api.github.com/users/shrewdlogarithm/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrewdlogarithm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrewdlogarithm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrewdlogarithm/subscriptions",
      "organizations_url": "https://api.github.com/users/shrewdlogarithm/orgs",
      "repos_url": "https://api.github.com/users/shrewdlogarithm/repos",
      "events_url": "https://api.github.com/users/shrewdlogarithm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrewdlogarithm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-10T03:16:07Z",
    "updated_at": "2015-03-10T03:16:07Z",
    "body": "Ironically - I changed from \"win.on(\" because it's written as \"win.close =\n\" in the docs ;0\n\nOn 10 March 2015 at 03:12, Benjamin Winkler notifications@github.com\nwrote:\n\n> win.close = function() {} overwrites the close function of your win.\n> You're using jquery-syntax. Attach listeners with win.on instead.\n> \n> Don't know about different behaviour when closed from menu, though.\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/atom/atom-shell/issues/1223#issuecomment-77988590.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/77989684",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-77989684",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 77989684,
    "user": {
      "login": "bwin",
      "id": 1673361,
      "avatar_url": "https://avatars1.githubusercontent.com/u/1673361?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bwin",
      "html_url": "https://github.com/bwin",
      "followers_url": "https://api.github.com/users/bwin/followers",
      "following_url": "https://api.github.com/users/bwin/following{/other_user}",
      "gists_url": "https://api.github.com/users/bwin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bwin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bwin/subscriptions",
      "organizations_url": "https://api.github.com/users/bwin/orgs",
      "repos_url": "https://api.github.com/users/bwin/repos",
      "events_url": "https://api.github.com/users/bwin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bwin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-10T03:26:02Z",
    "updated_at": "2015-03-10T03:26:02Z",
    "body": "In https://github.com/atom/atom-shell/blob/master/docs/api/browser-window.md (line 10) it's with `.on`. Couldn't find it as `win.close` through search. Maybe you we're looking at an old version and it is already fixed?\n\nAre you still experiencing different behavior when closed from the menu?\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78101916",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78101916",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78101916,
    "user": {
      "login": "zcbenz",
      "id": 639601,
      "avatar_url": "https://avatars3.githubusercontent.com/u/639601?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zcbenz",
      "html_url": "https://github.com/zcbenz",
      "followers_url": "https://api.github.com/users/zcbenz/followers",
      "following_url": "https://api.github.com/users/zcbenz/following{/other_user}",
      "gists_url": "https://api.github.com/users/zcbenz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zcbenz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zcbenz/subscriptions",
      "organizations_url": "https://api.github.com/users/zcbenz/orgs",
      "repos_url": "https://api.github.com/users/zcbenz/repos",
      "events_url": "https://api.github.com/users/zcbenz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zcbenz/received_events",
      "type": "User",
      "site_admin": true
    },
    "created_at": "2015-03-10T17:17:56Z",
    "updated_at": "2015-03-10T17:17:56Z",
    "body": "You should use [close](https://github.com/atom/atom-shell/blob/master/docs/api/browser-window.md#event-close) event for this, it is not supported to override existing APIs in atom-shell.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78158124",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78158124",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78158124,
    "user": {
      "login": "shrewdlogarithm",
      "id": 4963937,
      "avatar_url": "https://avatars0.githubusercontent.com/u/4963937?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrewdlogarithm",
      "html_url": "https://github.com/shrewdlogarithm",
      "followers_url": "https://api.github.com/users/shrewdlogarithm/followers",
      "following_url": "https://api.github.com/users/shrewdlogarithm/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrewdlogarithm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrewdlogarithm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrewdlogarithm/subscriptions",
      "organizations_url": "https://api.github.com/users/shrewdlogarithm/orgs",
      "repos_url": "https://api.github.com/users/shrewdlogarithm/repos",
      "events_url": "https://api.github.com/users/shrewdlogarithm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrewdlogarithm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-10T22:01:09Z",
    "updated_at": "2015-03-10T22:01:09Z",
    "body": "First - the line in the docs which inspired my change of event assigned is this\n\n```\nwindow.onbeforeunload = function(e) {\n```\n\nI've switched back to win.on(\"close\",function()... syntax  and I'm still having issues - the main issue being that the event either never fires or at least never completes (and throws no errors and cannot be debugged in the devtools because the Window closes before it can do that)\n\nI've tried the following code (intended to save window size/position) with both 'close' and 'beforeunload' events - it NEVER fires with the beforeunload, it SOMETIMES runs the first 'closing' message when run via 'close' - but nothing else (no errors - nothing else happens)\n\nwin is assigned from remote.getCurrentWindow() at window creation time.\n\n```\nwin.on(\"close\",function() {\n            debugger // this won't work - window closes before debugger catches it???\n            try {\n                console.log(\"closing\")\n                if (win.isMaximized())\n                    win.unMaximize()\n                else if (win.isMinimized())\n                    win.restore()\n                console.log(\"closing2\")\n                console.log(win.getPosition())\n                console.log(win.getSize())\n                console.log(\"closing3\")\n                PREFS.setPref(\"COREwinx\", win.getPosition()[0])\n                PREFS.setPref(\"COREwiny\", win.getPosition()[1])\n                PREFS.setPref(\"COREwinwidth\", win.getSize()[0])\n                PREFS.setPref(\"COREwinheight\", win.getSize()[1])\n                console.log(\"done\")\n            } catch (e) {\n                console.log(\"Error\")\n                console.log(e)\n            }\n        })\n```\n\nSomething is not working as intended - note that beforeunload isn't ideal anyway and I don't really want to run this on reload...\n\np.s. this happens however I close the window - via win.close() or right-clicking the menu or even from main.js using app.quit()\n\nNote also that app.quit() has it's own issues, including throwing a LOT of errors about missing callbacks and other problems - it's NOT the way to close an active app at this point...\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78190490",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78190490",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78190490,
    "user": {
      "login": "shrewdlogarithm",
      "id": 4963937,
      "avatar_url": "https://avatars0.githubusercontent.com/u/4963937?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrewdlogarithm",
      "html_url": "https://github.com/shrewdlogarithm",
      "followers_url": "https://api.github.com/users/shrewdlogarithm/followers",
      "following_url": "https://api.github.com/users/shrewdlogarithm/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrewdlogarithm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrewdlogarithm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrewdlogarithm/subscriptions",
      "organizations_url": "https://api.github.com/users/shrewdlogarithm/orgs",
      "repos_url": "https://api.github.com/users/shrewdlogarithm/repos",
      "events_url": "https://api.github.com/users/shrewdlogarithm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrewdlogarithm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-11T02:46:40Z",
    "updated_at": "2015-03-11T02:47:22Z",
    "body": "OK - I've narrowed it down and I think I know what the problem is - \n\n```\n    win.on(\"close\",function() {\n            try {\n                console.log(\"closing\") // this o\n                if (win.isMaximized()) // this silently fails???\n                  ... // so nothing else runs from here onwards\n            } catch (e) {\n                // but oddly, this doesn't run either???\n                console.log(\"Error\")\n                console.log(e)\n            }\n        })\n```\n\nI suspect this relates to the errors you sometimes get if you reload a page/use app.quit() - you get errors to non-existant functions/callbacks which belong to 'win' (remote.getCurrentWindow() in this case)\n\nWhat I've found is using\n\n```\nwindow.onbeforeunload = function() {\n    // \"win\" is accessible in here just fine\n    // just bear-in-mind this will run on reload as well as close\n}\n```\n\nworks OK tho\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78258879",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78258879",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78258879,
    "user": {
      "login": "shrewdlogarithm",
      "id": 4963937,
      "avatar_url": "https://avatars0.githubusercontent.com/u/4963937?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrewdlogarithm",
      "html_url": "https://github.com/shrewdlogarithm",
      "followers_url": "https://api.github.com/users/shrewdlogarithm/followers",
      "following_url": "https://api.github.com/users/shrewdlogarithm/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrewdlogarithm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrewdlogarithm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrewdlogarithm/subscriptions",
      "organizations_url": "https://api.github.com/users/shrewdlogarithm/orgs",
      "repos_url": "https://api.github.com/users/shrewdlogarithm/repos",
      "events_url": "https://api.github.com/users/shrewdlogarithm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrewdlogarithm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-11T13:05:39Z",
    "updated_at": "2015-03-11T13:05:39Z",
    "body": "I've uploaded a test project to demo this (and another issue I'll raise separately re: Tray in OSX)\n\nhttps://github.com/shrewdlogarithm/atom-shell-crash-demo\n\nIf that helps...\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78261336",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78261336",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78261336,
    "user": {
      "login": "bwin",
      "id": 1673361,
      "avatar_url": "https://avatars1.githubusercontent.com/u/1673361?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bwin",
      "html_url": "https://github.com/bwin",
      "followers_url": "https://api.github.com/users/bwin/followers",
      "following_url": "https://api.github.com/users/bwin/following{/other_user}",
      "gists_url": "https://api.github.com/users/bwin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bwin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bwin/subscriptions",
      "organizations_url": "https://api.github.com/users/bwin/orgs",
      "repos_url": "https://api.github.com/users/bwin/repos",
      "events_url": "https://api.github.com/users/bwin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bwin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-11T13:22:37Z",
    "updated_at": "2015-03-11T13:33:50Z",
    "body": "**Edit:** This is wrong, as I meant the close**d**-event.\n\nIn the close-event it's definitely too late to do something window-related. Imagine a server: When you get a close-event on a connection you can't send anymore because the connection is closed.\nI understand the confusion though (if you come from nw.js), as they handle their close-events differently (and even allow cancelling it from within the close-event).\nThe beforeunload-event is the way to go in your case.\nThe caveat however, as you wrote (and I didn't knew) is that\n\n> this will run on reload as well as close\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78262303",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78262303",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78262303,
    "user": {
      "login": "shrewdlogarithm",
      "id": 4963937,
      "avatar_url": "https://avatars0.githubusercontent.com/u/4963937?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/shrewdlogarithm",
      "html_url": "https://github.com/shrewdlogarithm",
      "followers_url": "https://api.github.com/users/shrewdlogarithm/followers",
      "following_url": "https://api.github.com/users/shrewdlogarithm/following{/other_user}",
      "gists_url": "https://api.github.com/users/shrewdlogarithm/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/shrewdlogarithm/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/shrewdlogarithm/subscriptions",
      "organizations_url": "https://api.github.com/users/shrewdlogarithm/orgs",
      "repos_url": "https://api.github.com/users/shrewdlogarithm/repos",
      "events_url": "https://api.github.com/users/shrewdlogarithm/events{/privacy}",
      "received_events_url": "https://api.github.com/users/shrewdlogarithm/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-11T13:28:49Z",
    "updated_at": "2015-03-11T13:28:49Z",
    "body": "The documentation implies that it's possible to prevent a window from\nclosing in the \"close\" event and it occurs BEFORE beforeunload fires too!\n\nYou can prevent the window closing in beforeunload - so you should be able\nto in close (the docs imply this is the case)\n\nSo this is clearly a bug - win should not be unassigned or unavailable\nduring 'close' because you may cancel the event - and indeed want to refer\nto it in beforeunload or even unload!??!?\n\ntl;dr version\n\nReferencing remote.getCurrentWindow() in win.on(\"close\" fails (silently) -\nbut works in window.beforeunload DESPITE that running later!?\n\nOn 11 March 2015 at 13:22, Benjamin Winkler notifications@github.com\nwrote:\n\n> In the close-event it's definitely too late to do something\n> window-related. Imagine a server: When you get a close-event on a\n> connection you can't send anymore because the connection is closed.\n> I understand the confusion though (if you come from nw.js), as they handle\n> their close-events differently (and even allow cancelling it from within\n> the close-event).\n> The beforeunload-event is the way to go in your case.\n> The caveeat however, as you wrote (and I didn't knew) is that\n> \n> this will run on reload as well as close\n> \n> —\n> Reply to this email directly or view it on GitHub\n> https://github.com/atom/atom-shell/issues/1223#issuecomment-78261336.\n"
  },
  {
    "url": "https://api.github.com/repos/electron/electron/issues/comments/78262851",
    "html_url": "https://github.com/electron/electron/issues/1223#issuecomment-78262851",
    "issue_url": "https://api.github.com/repos/electron/electron/issues/1223",
    "id": 78262851,
    "user": {
      "login": "bwin",
      "id": 1673361,
      "avatar_url": "https://avatars1.githubusercontent.com/u/1673361?v=3",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bwin",
      "html_url": "https://github.com/bwin",
      "followers_url": "https://api.github.com/users/bwin/followers",
      "following_url": "https://api.github.com/users/bwin/following{/other_user}",
      "gists_url": "https://api.github.com/users/bwin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bwin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bwin/subscriptions",
      "organizations_url": "https://api.github.com/users/bwin/orgs",
      "repos_url": "https://api.github.com/users/bwin/repos",
      "events_url": "https://api.github.com/users/bwin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bwin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2015-03-11T13:32:09Z",
    "updated_at": "2015-03-11T13:32:09Z",
    "body": ":sob: I'm sorry, I confused `close` and `closed`... I was talking about close**d**, but you were asking about close.\n"
  }
]